{
    "id": "RC7bfe1578a339443b88c5ce8f2f124265",
    "type": "rule_components",
    "attributes": {
        "created_at": "2022-09-22T16:25:24.027Z",
        "delegate_descriptor_id": "core::actions::custom-code",
        "deleted_at": null,
        "dirty": false,
        "name": "SOT - Async Page View ",
        "negate": false,
        "order": 1,
        "rule_order": 50,
        "timeout": 2000,
        "delay_next": true,
        "published": false,
        "published_at": null,
        "revision_number": 0,
        "updated_at": "2025-06-23T06:37:23.342Z",
        "created_by_email": "Naveen.Vinala@sephora.com",
        "created_by_display_name": "Naveen Vinala",
        "updated_by_email": "abhinav.alkuchi@sephora.com",
        "updated_by_display_name": "abhinav alkuchi",
        "settings": "{\"source\":\"//console.log('async page load for adobe !', Math.random())\\n(async function () {\\n  function readCookie(name) {\\n    let nameEQ = name + \\\"=\\\";\\n    let ca = document.cookie.split(\\\";\\\");\\n    for (let i = 0; i \\u003c ca.length; i++) {\\n      let c = ca[i];\\n      while (c.charAt(0) === \\\" \\\") c = c.substring(1, c.length);\\n      if (c.indexOf(nameEQ) === 0)\\n        return c.substring(nameEQ.length, c.length);\\n    }\\n    return null;\\n  }\\n  function getEventAttribute(attributePath) {\\n    return Sephora.analytics.utils.getMostRecentEventProperty({\\n      pathToProperty: attributePath,\\n      fallBackEventName: Sephora.analytics.constants.ASYNC_PAGE_LOAD,\\n    });\\n  }\\n\\n  function safelyReadProperty(attributePath, objectInfo) {\\n    return Sephora.analytics.utils.safelyReadProperty(attributePath, objectInfo);\\n  }\\n\\n  function getEventDetail(attributePath) {\\n    const data = event.detail;\\n    return data ? safelyReadProperty(attributePath, data) : \\\"\\\";\\n  }\\n\\n  function getProductNthLevelCategory() {\\n    if (digitalData.product \\u0026\\u0026 digitalData.product[0]) {\\n      return (digitalData.product[0].attributes \\u0026\\u0026 digitalData.product[0].attributes.nthLevelCategory || \\\"n/a\\\");\\n    } else {\\n      return \\\"n/a\\\";\\n    }\\n  }\\n\\n  function formatSotType(sotType) {\\n    return sotType \\u0026\\u0026 sotType.toLowerCase().replace(/([\\\\:\\\\-])/g, \\\" \\\");\\n  }\\n\\n  function getValidLinkName(sotType) {\\n    if(typeof sotType === \\\"undefined\\\" || sotType === null || sotType === \\\"null\\\") {\\n              return false;\\n      } \\n    return true;\\n  }\\n  \\n function extractNumberAfterEqualSign(input) {\\n    var regex = /=(\\\\d+)/g;\\n    var matches = input.match(regex);\\n    return matches ? matches.map(match =\\u003e match.substring(1)).join(\\\";\\\") : \\\"\\\";\\n  }\\n  \\n  function getAdditionalSotVars() {\\n    var itemsByBasket = digitalData.cart.itemsByBasket || [];\\n    var skuIds = \\\"\\\",\\n      cartCumulativeValue = 0,\\n      itemPrice = 0;\\n\\n    for (var i = 0; i \\u003c itemsByBasket.length; i++) {\\n\\n      var item = itemsByBasket[i].items;\\n      for (var j = 0; j \\u003c item.length; j++) {\\n        skuIds += item[j].sku.skuId + (item.length - 1 === j ? \\\"\\\" : \\\";\\\");\\n        if (item[j].salePriceSubtotal) {\\n          itemPrice = Number(item[j].salePriceSubtotal.slice(1));\\n        } else {\\n          itemPrice = Number(item[j].listPriceSubtotal.slice(1));\\n        }\\n        cartCumulativeValue += isNaN(itemPrice) ? 0 : itemPrice;\\n      }\\n      skuIds = skuIds + (i === itemsByBasket.length - 1 ? \\\"\\\" : \\\";\\\");\\n    }\\n\\n    return {\\n      sotV04: skuIds,\\n      sotV11: cartCumulativeValue\\n    };\\n  }\\n  \\n  function getPlatform() {\\n  const isMobile = Sephora.isMobile();\\n  if (isMobile) {\\n    return \\\"mobile\\\";\\n  } else if (Sephora.isTouch \\u0026\\u0026 !isMobile) {\\n    return \\\"tablet web\\\";\\n  } else {\\n    return \\\"desktop web\\\";\\n  }\\n}\\n\\n  try {\\n    //console.log(getEventAttribute(\\\"eventInfo.attributes\\\"));\\n    const asyncEventStrings = (getEventAttribute(\\\"eventInfo.attributes.eventStrings\\\") || []).join(\\\",\\\");\\n    const asyncPageType = getEventAttribute(\\\"eventInfo.attributes.pageType\\\") || \\\"\\\";\\n    //console.log('sot log asyncEventStrings', asyncEventStrings)\\n    const eventInfoAttributes = getEventAttribute(\\\"eventInfo.attributes\\\");\\n    const eventProductId = getEventAttribute(\\\"eventInfo.attributes.productId\\\");\\n\\n    const quickLook = asyncPageType === \\\"quicklook\\\" \\u0026\\u0026 asyncEventStrings.indexOf(\\\"event25\\\") !== -1;\\n    const login = asyncEventStrings.indexOf(\\\"event100\\\") !== -1;\\n    const biReg = asyncEventStrings.indexOf(\\\"event15,event11,event39\\\") !== -1;\\n    //console.log('sot log quickLook', quickLook, 'login', login, 'biReg', biReg);\\n    const sotType = quickLook ? \\\"QuickLook\\\" : (login ? \\\"Login\\\" : (biReg ? \\\"BI Registration\\\" : \\\"\\\"));\\n    //console.log('sot log sotType', sotType);\\n    const sotSubCategory = getProductNthLevelCategory();\\n    const currency = digitalData.page.pageInfo.country === \\\"US\\\" ? \\\"USD\\\" : \\\"CAD\\\";\\n    const fbpValue = readCookie('_fbp');\\n    const fbcValue = readCookie('_fbc');\\n    //console.log(fbcValue, 'fbc value adobe 1')\\n    const platform = digitalData?.page?.attributes?.platform ? digitalData.page.attributes.platform : getPlatform() || \\\"\\\";\\n    const emailId = digitalData.user[0].profile[0].profileInfo.email;\\n    const signInStatus = digitalData.user[0].segment.signInStatus;\\n    const timestamp = new Date().getTime();\\n    const ipAddress = await _satellite.getVar(\\\"[SOT] System :: IP Address\\\");\\n    const languageLocale = digitalData.page.attributes.languageLocale?.toLowerCase()?.slice(-2);\\n    const profileId = digitalData.user[0].profile[0].profileInfo.profileID;\\n    const pageTitle = eventInfoAttributes.pageName;\\n    const pageType = eventInfoAttributes.pageType;\\n    const pageTypeDetail = eventInfoAttributes.pageDetail;\\n    const pageWorld = eventInfoAttributes.world || 'n/a';\\n    const productId = eventInfoAttributes.skuId;\\n    const biAccountId = digitalData.user[0].segment.biAccountId;\\n    const biStatus = digitalData.user[0].segment.biStatus;\\n    const biPoints = digitalData.user[0].segment.biPoints;\\n    const referrerCode = digitalData.page.attributes.campaigns.marketingChannel;\\n    const contentCategory = digitalData.page.category.primaryCategory;\\n    const orderId = location.href.split('orderId=')[1] || location.href.split('orderdetail/')[1];\\n    const ccpaConsentCookie = readCookie(\\\"ccpaConsentCookie\\\") === '1' ? 1 : 0;\\n    const sponsoredProductInformation = eventInfoAttributes.sponsoredProductInformation;\\n    const sc_click_id = sessionStorage.getItem(\\\"sc_click_id\\\");\\n    let epikLS = JSON.parse(window.localStorage.getItem(\\\"_epik_ls\\\"));\\n    let epikLSValid = epikLS?.expires \\u0026\\u0026 epikLS?.value \\u0026\\u0026 !isNaN(new Date(epikLS.expires)) \\u0026\\u0026 new Date(epikLS.expires) \\u003e= new Date();\\n    let epikId = new URL(window.location.href).searchParams.get(\\\"epik\\\") || _satellite.cookie.get('_epik') || (epikLSValid \\u0026\\u0026 epikLS.value) || \\\"\\\";\\n\\n    const utmParameters = JSON.parse(window.localStorage.getItem(\\\"utmParameters\\\"));\\n    const allowUtm = utmParameters?.expiration \\u003e= new Date().getTime() ? true : \\\"\\\";\\n    const {\\n      utm_id,\\n      utm_source,\\n      utm_medium,\\n      utm_campaign,\\n      utm_source_platform,\\n      utm_term,\\n      utm_content,\\n      utm_creative_format,\\n      utm_marketing_tactic\\n    } = allowUtm ? utmParameters : {};\\n    const lowerCaseParams = new URLSearchParams(\\n      Array.from(new URLSearchParams(new URL(window.location.href).search), ([key, value]) =\\u003e [key.toLowerCase(), value])\\n    );\\n    const rdtCidURL = lowerCaseParams.get('rdt_cid');\\n    rdtCidURL \\u0026\\u0026 sessionStorage.setItem('rdt_cid', rdtCidURL);\\n\\n    //SA-1324\\n      let sotV238Val = null;\\n      let sotV246Val = null;\\n      if(digitalData \\u0026\\u0026 digitalData.page \\u0026\\u0026 digitalData.page.attributes \\u0026\\u0026 digitalData.page.attributes.date) {\\n        sotV238Val = digitalData.page.attributes.date.timeZone ? digitalData.page.attributes.date.timeZone : \\\"\\\";\\n        sotV246Val = digitalData.page.attributes.date.timeZoneName ? digitalData.page.attributes.date.timeZoneName : \\\"\\\";\\n      }\\n    \\n    let cartInfo = getAdditionalSotVars();\\n    \\n    let dataToSend = {\\n      sotVars: {\\n        sotV03: 'D=pageName',\\n        sotV09: currency,\\n        sotV13: ccpaConsentCookie,\\n        sotV52: _satellite.getVar('[TMS] SiteCatalyst :: Account ID'),\\n        sotV53: _satellite.getVar('[TMS] Channel'),\\n        sotV62: _satellite.getVar('[TMS] Page :: Page Name for eVar6 - pageLoadEvent'),\\n        sotV66: 'D=c27',\\n        sotV67: 'D=c9',\\n        sotV68: _satellite.getVar('[TMS] Page :: Experience'),\\n        sotV72: _satellite.getVar('[TMS] Page :: Audience Segmentation'),\\n        sotV73: _satellite.getVar('[TMS] Page :: Day of Week'),\\n        sotV75: _satellite.getVar('[TMS] Page :: Search Type - asyncPageLoad'),\\n        /* Remove this sotV77 in stagging and prod only for differenating between signal and adobe including it. */\\n        sotV77: 'adobe triggered',\\n        sotV82: 'D=c6',\\n        sotV83: 'D=c8',\\n        sotV85: 'D=User-Agent',\\n        sotV86: 'D=c9',\\n        sotV87: 'D=g',\\n        //sotV92: _satellite.getVar('AdBanner'),\\n        sotV98: _satellite.getVar('[TMS] Page :: Experience Store ID - asyncPageLoad'),\\n        sotV103: _satellite.getVar('[TMS] Page :: Experience Type'),\\n        sotV104: _satellite.getVar('[TMS] Page :: Search Term'),\\n        sotV105: _satellite.getVar('[TMS] Page :: Number of Results - asyncPageLoad'),\\n        sotV110: _satellite.getVar('[TMS] Page :: Date'),\\n        sotV111: _satellite.getVar('[TMS] User :: Accepted Advertising Cookies'),\\n        sotV113: 'D=v62',\\n        sotV114: _satellite.getVar('[TMS] Event :: Last Refresh'),\\n        //sotV120: _satellite.getVar('[TMS] adBannersOn'),\\n        sotV121: _satellite.getVar('[TMS] Async Page Name - asyncPageLoad'),\\n        sotV122: _satellite.getVar('[TMS] Async Event Strings - asyncPageLoad'),\\n        sotV123: _satellite.getVar('[TMS] Async Product Strings'),\\n        sotV124: 'D=c4',\\n        sotV125: _satellite.getVar('[TMS] Async Internal Campaign String'),\\n        sotV126: _satellite.getVar('[TMS] Async :: Certona Audience Id'),\\n        sotV127: _satellite.getVar('[TMS] Async :: Category Filters'),\\n        sotV128: _satellite.getVar('[TMS] Async Previous Navigation Information'),\\n        sotV129: _satellite.getVar('[TMS] Async :: User :: BIFlash'),\\n        sotV130: _satellite.getVar('[TMS] Async Internal Campaign String'),\\n        sotV131: _satellite.getVar('[TMS] Async :: Page :: Type'),\\n        sotV132: _satellite.getVar('[TMS] Async :: Page :: Page Detail - asyncPageLoad'),\\n        sotV133: _satellite.getVar('[TMS] Async :: World'),\\n        sotV134: _satellite.getVar('[TMS] Async :: Page :: Credit Card Status'),\\n        sotV135: _satellite.getVar('[TMS] Async :: Certona Audience Id'),\\n        sotV136: _satellite.getVar('[TMS] Async Previous Page Name - asyncPageLoad'),\\n        sotV137: _satellite.getVar('[TMS] Async Previous Page Type - asyncPageLoad'),\\n        sotV138: _satellite.getVar('[TMS] Async :: User :: BI Status'),\\n        sotV139: _satellite.getVar('[TMS] Async :: User :: ATG ID - page load or async page load'),\\n        sotV140: _satellite.getVar('[TMS] Page :: Certona Placement :: Quicklooks'),\\n        sotV141: _satellite.getVar('[TMS] Async :: Page :: Content Country'),\\n        sotV142: _satellite.getVar('[TMS] Async :: User :: Sign In Status'),\\n        sotV143: _satellite.getVar('[TMS] Async :: Page Load Time'),\\n        sotV115: _satellite.getVar('[TMS] User :: Play Status'),\\n        sotV144: _satellite.getVar('[TMS] Async Previous Link Data'),\\n        sotV145: _satellite.getVar('[TMS] Async Feature Strings'),\\n        sotV146: _satellite.getVar('[TMS] Async :: Dynamic Category Filter'),\\n        sotV119: _satellite.getVar('[TMS] Page :: Country'),\\n        sotV147: _satellite.getVar('[TMS] Async :: Page :: Type'),\\n        sotV225: 'AL',\\n        sotV226: false,\\n        sotV237: _satellite.getVar(\\\"[SOT] Page :: language locale\\\"),\\n        sotV238: sotV238Val,\\n        sotV246: sotV246Val,\\n        sotV254: cartInfo.sotV04 || \\\"n/a\\\",\\n        sotV295: sc_click_id,\\n        sotV302: _satellite.readCookie('ttclid') || \\\"\\\",\\n        sotV303: _satellite.readCookie('_ttp') || \\\"\\\",\\n        sotV324: new URL(window.location.href).searchParams.get(\\\"gclid\\\"),\\n        sotV325: epikId,\\n        sotV327: _satellite.getVar(\\\"[SOT] :: Forter Token\\\") || \\\"\\\",\\n        sotV278: _satellite.readCookie('referrer') || \\\"\\\",\\n        sotV341: _satellite.getVar(\\\"[SOT] :: URL Navigation History\\\") || \\\"\\\",\\n        sotV349: utm_id,\\n        sotV350: utm_source,\\n        sotV351: utm_medium,\\n        sotV352: utm_campaign,\\n        sotV353: utm_source_platform,\\n        sotV354: utm_term,\\n        sotV355: utm_content,\\n        sotV356: utm_creative_format,\\n        sotV357: utm_marketing_tactic,\\n        sotV361: sessionStorage.getItem('rdt_cid'),\\n        sotV362: _satellite.readCookie('_rdt_uuid') || \\\"\\\",\\n        sotV399: _satellite.getVar(\\\"[SOT] Page :: event_date_PST\\\")\\n      }\\n    };\\n\\n\\n    let additionalDataToSend = {\\n      campaign: {\\n        referrerCode: referrerCode,\\n      },\\n      sysInfo: {\\n        userLanguage: languageLocale,\\n        ipAddress: _satellite.getVar('[TMS] System Var - IP'),\\n      },\\n      pageInfo: {\\n        title: pageTitle,\\n      },\\n      session: {\\n        biId: biAccountId,\\n        biTier: biStatus,\\n        biPoints: biPoints,\\n        profileId: profileId,\\n        platform: platform,\\n        emailId: emailId,\\n        signInState: signInStatus,\\n        atgId: _satellite.getVar('[TMS] Async :: User :: ATG ID - page load or async page load'),\\n        timestamp: timestamp\\n      },\\n      sotProps: {\\n        sot20: timestamp + \\\"\\\"\\n      },\\n      sotVars: {\\n        sotSubType: pageType,\\n        sotCategory: contentCategory,\\n        sotV01: pageTypeDetail,\\n        sotV02: pageWorld,\\n        sotV04: productId,\\n        sotV12: fbpValue,\\n        sotV232: fbcValue\\n      },\\n      eventTime: timestamp,\\n      eventId: _satellite.getVar(\\\"[UEID] :: Universal Event ID Fx\\\")(event) || _satellite.getVar(\\\"[TMS] :: Event Id\\\")\\n    };\\n\\n    const allowTracking = !!sotType;\\n    const sotV122 = dataToSend.sotVars.sotV122;\\n    const isStaySignedInOn = sotV122 \\u0026\\u0026 sotV122.indexOf(\\\"event140,event100\\\") != -1 \\u0026\\u0026 dataToSend.sotVars.sotV144 === \\\"stay signed in\\\";\\n\\n    if (allowTracking) {\\n\\n      if (sotType === \\\"QuickLook\\\") {\\n        if (sponsoredProductInformation \\u0026\\u0026 sponsoredProductInformation.isSponsoredProduct) {\\n          const clickTrackingId = sponsoredProductInformation.clickTrackerId + ';' + sponsoredProductInformation.clickPayload;\\n          additionalDataToSend.sotVars.sotV191 = clickTrackingId;\\n        }\\n        const skuPrice = digitalData.product \\u0026\\u0026 digitalData.product.length \\u0026\\u0026 digitalData.product[0].attributes \\u0026\\u0026 digitalData.product[0].attributes.price || '';\\n        const skuBrand = digitalData.product \\u0026\\u0026 digitalData.product.length \\u0026\\u0026 digitalData.product[0].productInfo \\u0026\\u0026 digitalData.product[0].productInfo.manufacturer || '';\\n        const productName = digitalData.product \\u0026\\u0026 digitalData.product.length \\u0026\\u0026 digitalData.product[0].productInfo \\u0026\\u0026 digitalData.product[0].productInfo.productName || '';\\n\\n        additionalDataToSend.sotVars.sotV02 = productName;\\n        additionalDataToSend.sotVars.sotV06 = skuPrice;\\n        additionalDataToSend.sotVars.sotV07 = skuBrand;\\n        additionalDataToSend.sotVars.sotV15 = eventProductId;\\n        additionalDataToSend.sotVars.sotV277 = ipAddress;\\n\\n        // ORCH-2133\\n        const productData = getEventDetail(\\\"data.product\\\");\\n        if (productData) {\\n          // Formats the Price.\\n          var om_price = productData?.currentSku?.salePrice || productData?.currentSku?.listPrice || '';\\n          om_price = om_price.replace(',', '.');\\n          om_price = om_price.replace('$', '');\\n          om_price = om_price.trim();\\n\\n          var om_original_price = productData?.currentSku?.listPrice || '';\\n          om_original_price = om_original_price.replace(',', '.');\\n          om_original_price = om_original_price.replace('$', '');\\n          om_original_price = om_original_price.trim();\\n\\n          const getLastNestedId = (obj, keyField, childKey) =\\u003e {\\n            const id = obj[keyField];\\n            if (obj[childKey] === undefined) {\\n              return id;\\n            }\\n            return getLastNestedId(obj[childKey], keyField, childKey);\\n          };\\n          \\n          var om_is_new = productData?.currentSku?.isNew === undefined ? false : productData?.currentSku?.isNew;\\n          var om_out_of_stock = productData?.currentSku?.isOutOfStock === undefined ? false : productData?.currentSku?.isOutOfStock;\\n          var om_is_limited_edition = productData?.currentSku?.isLimitedEdition === undefined ? false : productData?.currentSku?.isLimitedEdition;\\n          var om_is_app_exclusive = productData?.currentSku?.isAppExclusive === undefined ? false : productData?.currentSku?.isAppExclusive;\\n\\n          // Key Identifying the department or highest level of category.\\n          var on_department = getLastNestedId(productData?.parentCategory || {}, 'categoryId', 'parentCategory');\\n\\n          var orchParameters = {\\n            sotV215: productData?.currentSku?.productName,\\n            sotV365: profileId \\u0026\\u0026 await Sephora?.analytics?.utils?.hashString(profileId),\\n            sotV366: biAccountId \\u0026\\u0026 await Sephora?.analytics?.utils?.hashString(biAccountId),\\n            sotV367: Number(om_price || ''),\\n            sotV368: productData?.currentSku?.skuImages?.image250 || '',\\n            sotV369: productData?.fullSiteProductUrl || '',\\n            sotV370: productData?.currentSku?.isBiReward,\\n            sotV371: productData?.parentCategory?.displayName || '',\\n            sotV372: productData?.parentCategory?.categoryId || '',\\n            sotV373: productData?.currentSku?.nthLevelCategoryId || '',\\n            sotV374: productData?.currentSku?.rating || 0,\\n            sotV375: productData?.currentSku?.rating || 0,\\n            sotV376: productData?.currentSku?.variationType || '',\\n            sotV377: productData?.productDetails?.suggestedUsage || '',\\n            sotV378: om_is_app_exclusive,\\n            sotV379: om_is_limited_edition,\\n            sotV380: om_is_new,\\n            sotV381: om_is_new,\\n            sotV382: productData?.currentSku?.reviews || 0,\\n            sotV383: productData?.productDetails?.lovesCount || 0,\\n            sotV384: productData?.productDetails?.shortDescription || '',\\n            sotV385: on_department || ''\\n            // --- N/A orchParameters... ---\\n            // \\\"bluecore_parent_id\\\":,\\n            // \\\"is_bluecore_parent\\\":,\\n            // \\\"has_refill_variant\\\": \\\"\\\",\\n            // \\\"is_refill_variant\\\": \\\"\\\",\\n            // \\\"is_mini\\\": \\\"\\\",\\n            // \\\"ca_on_sale\\\": \\\"\\\",\\n            // \\\"ca_klarna_pricing\\\": \\\"\\\",\\n            // \\\"ca_has_bis_signup_button\\\": \\\"\\\",\\n          };\\n\\n          if (Sephora.renderQueryParams.country === 'CA') {\\n            orchParameters = {\\n              ...orchParameters,\\n              // Canada (EN/FR) Only Parameters...\\n              sotV386: Number(om_price || ''),\\n              sotV387: Number(om_original_price || ''),\\n              sotV388: om_out_of_stock,\\n              sotV389: productData?.currentSku?.isSephoraExclusive\\n            }\\n          }\\n\\n          if (Sephora.renderQueryParams.language === 'fr') {\\n            orchParameters = {\\n              ...orchParameters,\\n              // Canada (FR) Only Parameters...\\n              sotV390: productData?.currentSku?.productName || '',\\n              sotV391: productData?.currentSku?.nthLevelCategory || '',\\n              sotV392: productData?.currentSku?.skuImages?.image250 || '',\\n              sotV393: productData?.productDetails?.suggestedUsage || ''\\n            }\\n          }\\n          additionalDataToSend.sotVars = {\\n            ...additionalDataToSend.sotVars, ...orchParameters\\n          }\\n        }\\n        //console.log('sot log QuickLook', additionalDataToSend);\\n        Object.assign(additionalDataToSend.sotVars, dataToSend.sotVars);\\n      }\\n      if (sotType === \\\"BI Registration\\\") {\\n        additionalDataToSend.sotVars.sotV178 = \\\"Yes\\\";\\n        additionalDataToSend.sotVars.sotV179 = (asyncEventStrings.indexOf(\\\"event6\\\") !== -1) ? \\\"Yes\\\" : \\\"No\\\";\\n        additionalDataToSend.sotVars.sotV277 = ipAddress;\\n        Object.assign(additionalDataToSend.sotVars, dataToSend.sotVars);\\n        //console.log('sot log BI Registration', additionalDataToSend);\\n      }\\n      if (sotType === \\\"Login\\\") {\\n        additionalDataToSend.sotVars.sotV148 = isStaySignedInOn ? 1 : 0;\\n        Object.assign(additionalDataToSend.sotVars, dataToSend.sotVars);\\n        //console.log('sot log login', additionalDataToSend);\\n      }\\n      var isValidLinkName = getValidLinkName(sotType);\\n      if(isValidLinkName) {\\n      (window.sephoraOneTag_cmds = window.sephoraOneTag_cmds || []).push(['trackEvent', formatSotType(sotType), additionalDataToSend]);\\n      }\\n    }\\n\\n    else {\\n      var allowedLinkActionInfo = [\\\"page view\\\", \\\"curbside:show pickup barcode\\\", \\\"Sku Items List Sort\\\", \\\"klarna terms of service\\\",\\\"basket switching:bopis\\\",\\\"view items and checkout:shipped\\\",\\n        \\\"view items and checkout:bopis\\\",\\\"basket switching:shipping and delivery\\\"];\\n      var set14OnwardsEvents = [\\n        // Set 18 events\\n        \\\"here for curbside click\\\",\\n        \\\"same day delivery:time selection modal open\\\"\\n      ];\\n\\n      var linkName = getEventAttribute(\\\"eventInfo.attributes.linkData\\\");\\n      var pageDetail = getEventAttribute(\\\"eventInfo.attributes.pageDetail\\\");\\n      //SA-1013\\n      var previousActionType = getEventDetail(\\\"data.previousActionType\\\") || null;\\n      var digitalDataPageType = digitalData.page.category.pageType;\\n      var accessPointFedexLocation = [\\\"access points-fedex location details\\\", \\\"accesss points-how it works\\\", \\\"access points location details\\\", \\\"fedex access points-how it works\\\", \\\"access points-no locations available\\\", \\\"access points-select location\\\", \\\"access points-selected location unavailable\\\"];\\n      var reportIssue = [\\\"ncr not eligible\\\", \\\"select reason\\\", \\\"select samples\\\", \\\"ncr eligible\\\"];\\n      var autoReplenishSDUPageView = [\\n        \\\"auto replenish:unsubscribe subscription open\\\",\\n        \\\"auto replenish:manage subscription open\\\",\\n        \\\"auto replenish:update payment open\\\",\\n        \\\"auto replenish:delivery frequency open\\\",\\n        \\\"auto replenish:resume subscription open\\\",\\n        \\\"same-day unlimited:edit payment open\\\",\\n        \\\"same-day unlimited:add payment open\\\",\\n        \\\"same-day unlimited:update payment open\\\",\\n        \\\"auto replenish:edit payment open\\\",\\n        \\\"auto replenish:add payment open\\\",\\n        \\\"auto replenish:skip subscription open\\\",\\n        \\\"auto replenish:pause subscription open\\\"\\n      ];\\n      \\n      var basketPageView = [\\n        \\\"sign-in:free-shipping\\\",\\n        \\\"sign-in:text-link\\\"\\n      ];\\n      \\n      //SA-874\\n      var orderDetailsPageView = [\\n        \\\"reasons\\\"\\n      ];\\n      \\n      var curbSidePageView = [\\n        \\\"curbside-pickup hours closed\\\",\\n        \\\"curbside-pickup verification\\\",\\n        \\\"curbside-details\\\",\\n        \\\"curbside-success\\\"\\n      ];\\n      //SA-1110\\n      var beautyPreferencesPageView = [\\n        \\\"shade finder-match found\\\"\\n      ];\\n      //SA-1263, SA-1264\\n      var beautyPreferenccesAccordionPageView = [\\n        \\\"select favorite brands\\\",\\n        \\\"ingredient preferences\\\",\\n        \\\"accordion\\\"\\n      ]\\n      \\n      //SA-1115, SA-1116, SA-1410, SA-1411\\n      var smsSignUpPageView = [\\n        \\\"sms-get order updates\\\",\\n        \\\"sms-confirmation\\\"\\n      ];\\n      \\n      //SA-2132\\n      var basketShippingPageView = [\\n        \\\"basket switching:bopis\\\",\\n        \\\"view items and checkout:shipped\\\",\\n        \\\"view items and checkout:bopis\\\",\\n        \\\"basket switching:shipping and delivery\\\"\\n      ];\\n      \\n      var creditCardPageView = [\\n        \\\"application-pending\\\",\\n        \\\"application-error\\\",\\n        \\\"application-approved\\\"\\n      ];\\n\\n      if (pageType === \\\"checkout\\\" \\u0026\\u0026 [\\\"delivery\\\", \\\"shipping\\\", \\\"payment\\\"].includes(pageTypeDetail)) {\\n           linkName = \\\"page view\\\";\\n\\n            const sotV01Mapping = {\\n              shipping: \\\"delivery\\\",\\n              delivery: \\\"shipping\\\",\\n              payment: \\\"payment\\\",\\n            };\\n\\n            additionalDataToSend.sotVars = {\\n              sotSubType: pageType,\\n              sotSubCategory: \\\"n/a\\\",\\n              sotV01: sotV01Mapping[pageTypeDetail],\\n              sotV02: \\\"n/a\\\",\\n            };\\n      }\\n\\n      if (linkName === \\\"alternate pickup person:edit\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: 'bopis',\\n          sotSubCategory: 'n/a',\\n          sotV01: 'alternate-pickup',\\n          sotV02: 'n/a',\\n          sotV88: 'alternate pickup person edit'\\n        }\\n      }\\n      if (linkName === \\\"alternate pickup person:request\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: 'bopis',\\n          sotSubCategory: 'n/a',\\n          sotV01: 'alternate-pickup',\\n          sotV02: 'n/a',\\n          sotV88: 'alternate pickup person request'\\n        }\\n      }\\n\\n      if (pageType === \\\"same-day unlimited\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: 'n/a',\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        }\\n\\n      }\\n\\n      if (pageDetail === \\\"same day-select delivery location\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: 'n/a',\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        }\\n      }\\n\\n      if (linkName === \\\"curbside:show pickup barcode\\\") {\\n        var dataEventDetail = eventInfoAttributes.linkData;\\n        additionalDataToSend.sotVars = {\\n          sotV160: dataEventDetail,\\n          sotV10: orderId,\\n        }\\n      }\\n      if (linkName === \\\"user profile:my account:email:update\\\") {\\n        linkName = \\\"page view\\\";\\n\\n        additionalDataToSend.sotVars = {\\n          sotSubType: digitalDataPageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld,\\n          sotV88: \\\"user profile my account email update\\\",\\n        };\\n      }\\n      if (pageDetail === \\\"lists-loves\\\") {\\n        var categoryFilters = getEventAttribute(\\\"eventInfo.attributes.categoryFilters\\\");\\n        if (categoryFilters \\u0026\\u0026 categoryFilters[0] \\u0026\\u0026 categoryFilters[0].indexOf(\\\"sortby=\\\") != -1) {\\n          linkName = \\\"Sku Items List Sort\\\";\\n          additionalDataToSend.sotVars = {\\n            sotV84: _satellite.getVar('[TMS] Async :: Category Filters'),\\n            sotV158: 'loves'\\n          }\\n        }\\n      }\\n\\n      if (pageDetail === \\\"klarna modal\\\") {\\n        linkName = \\\"klarna terms of service\\\";\\n      }\\n\\n      if (pageDetail === \\\"shipping-edit address\\\" || pageDetail === \\\"shipping-add address\\\" || pageDetail === \\\"sign in\\\" || pageDetail === \\\"reset password\\\" || pageDetail === \\\"register\\\" || pageDetail === \\\"shipping-double check your address\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotV01: pageDetail,\\n          sotV88: previousActionType\\n        };\\n      }\\n      if (digitalDataPageType === \\\"product\\\") {\\n        if (linkName === \\\"information icon\\\" \\u0026\\u0026 pageTitle === \\\"buy online and pickup:bcc information-modal:n/a:*\\\") {\\n          linkName = \\\"page view\\\";\\n          additionalDataToSend.sotVars = {\\n            sotSubType: pageType,\\n            sotV01: pageDetail,\\n            sotV88: \\\"buy online and pickup information icon\\\",\\n          };\\n        }\\n        if (linkName === \\\"shipping and returns\\\" \\u0026\\u0026 pageTitle.indexOf(\\\"contentstore:customer service help-shipping information\\\") !== -1) {\\n          linkName = \\\"page view\\\";\\n          additionalDataToSend.sotVars = {\\n            sotSubType: pageType,\\n            sotV01: \\\"customer service help-shipping information\\\",\\n            sotV88: eventInfoAttributes.linkData\\n          };\\n        }\\n      }\\n\\n      if (digitalDataPageType === \\\"brand\\\") {\\n        if (dataToSend.sotVars.sotV127.indexOf(\\\"sortby\\\") !== -1) {\\n          linkName = \\\"page view\\\";\\n          additionalDataToSend.sotVars = {\\n            sotSubType: digitalDataPageType,\\n            sotV01: dataToSend.sotVars.sotV132,\\n            sotV84: dataToSend.sotVars.sotV127,\\n            sotV88: \\\"brand products refinement apply\\\",\\n          };\\n        }\\n      }\\n\\n      if (digitalDataPageType === \\\"curbside\\\" \\u0026\\u0026 pageDetail.indexOf(\\\"curbside-pickup\\\") != -1) {\\n        linkName = \\\"here for curbside click\\\";\\n        additionalDataToSend.sotVars = {\\n          sotV10: location.href.split('orderId=')[1] ||\\n            location.href.split('orderdetail/')[1]\\n        };\\n      }\\n\\n      if (digitalDataPageType === \\\"productfinder\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: digitalDataPageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        };\\n      }\\n\\n      if (pageDetail === \\\"ratings\\u0026reviews-submit\\\" || (getEventAttribute(\\\"eventInfo.attributes.eventName\\\") === \\\"highlightedReviewsModal\\\" \\u0026\\u0026 pageDetail === \\\"ratings\\u0026reviews-highly rated modal\\\")) {\\n        linkName = \\\"page view\\\";\\n        let { brandName, productName, productId } = safelyReadProperty(\\\"page.attributes\\\", digitalData);\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: pageWorld,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld,\\n          sotV07: brandName || \\\"\\\",\\n          sotV15: productId || \\\"\\\",\\n          sotV215: productName || \\\"\\\",\\n          sotV340: digitalData?.page?.attributes?.totalReviews\\n        };\\n      }\\n\\n      if (pageDetail === \\\"payment-add credit card\\\" || pageDetail === \\\"flexible-payments modal\\\" || pageDetail === \\\"free returns-information\\\" || pageDetail === \\\"payment-edit credit card\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        };\\n      }\\n      if (pageDetail === \\\"reservation-details\\\" ||\\n        pageDetail === \\\"book a service-date \\u0026 location\\\" ||\\n        pageDetail === \\\"book a reservation-map\\\" ||\\n        pageDetail === \\\"cancel service-confirmation\\\" ||\\n        pageDetail === \\\"shade finder-landing page\\\" ||\\n        pageDetail === \\\"apply points\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotV01: pageTypeDetail\\n        };\\n      }\\n\\n      if (linkName === \\\"check other stores\\\" \\u0026\\u0026 pageDetail === \\\"store selection\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: 'n/a',\\n          sotV01: pageDetail,\\n          sotV88: 'check other stores'\\n        };\\n      }\\n\\n      if (pageDetail === \\\"nickname\\\" \\u0026\\u0026 pageType === \\\"social registration\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        };\\n      }\\n\\n      if (pageDetail === \\\"product highlight\\\" \\u0026\\u0026 pageType === \\\"product\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: pageWorld,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        };\\n      }\\n\\n      if (pageDetail === \\\"gift card shipping\\\" \\u0026\\u0026 pageType === \\\"checkout\\\" || pageDetail === 'gift card shipping-add address' || pageDetail === 'gift card shipping-edit address' || pageDetail === 'store locator') {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n          title: getEventDetail(\\\"data.pageName\\\") || \\\"\\\"\\n        };\\n        additionalDataToSend.sotVars = {\\n          sotSubType: pageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld\\n        };\\n      }\\n\\n      //SA-1435 \\u0026 SA-1436\\n      if (pageDetail === \\\"multi promo code modal\\\" \\u0026\\u0026 (pageType === \\\"basket\\\" || pageType === \\\"checkout\\\")) {\\n        linkName = \\\"page view\\\";\\n      }\\n\\n      //SA-1483\\n      if (pageDetail === \\\"gift message-choose design\\\" \\u0026\\u0026 pageType === \\\"modal\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: \\\"basket\\\",\\n          sotV01: pageTypeDetail\\n        };\\n      }\\n      \\n      if(['gift message-choose design', 'gift message-write message','gift message-preview'].includes(pageDetail) \\u0026\\u0026 pageType === \\\"modal\\\") {\\n        linkName = \\\"page view\\\";\\n        switch (pageDetail) {\\n          case 'gift message-choose design':\\n            additionalDataToSend.sotVars = {\\n              sotSubType: \\\"checkout\\\",\\n              sotV01: 'add gift message image'\\n            };\\n            break;\\n          case 'gift message-write message':\\n            additionalDataToSend.sotVars = {\\n              sotSubType: \\\"checkout\\\",\\n              sotV01: 'write gift message'\\n            };\\n            break;\\n          case 'gift message-preview':\\n            additionalDataToSend.sotVars = {\\n              sotSubType: \\\"checkout\\\",\\n              sotV01: 'gift message preview'\\n            };\\n            break;\\n          default:\\n            additionalDataToSend.sotVars = {\\n              sotSubType: \\\"checkout\\\",\\n              sotV01: pageDetail\\n            };\\n            break;\\n         }\\n      }\\n\\n      //SA-1482\\n      if (pageTitle === \\\"user profile:my account:bi lookup\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.sotVars = {\\n          sotSubType: digitalDataPageType\\n        };\\n      }\\n        \\n    const fedexData = getEventDetail(\\\"data.morePageInfo\\\") || null;\\n    let fedexPageDetail = null;\\n    let fedexPageType = null;\\n    let fedexPageName = null;\\n      if(fedexData \\u0026\\u0026 fedexData.oneTagPageName) {\\n        fedexPageName = fedexData.oneTagPageName;\\n      } else {\\n        fedexPageName = pageTitle || 'n/a';\\n      }\\n      if(fedexData \\u0026\\u0026 fedexData.oneTagPageDetail) {\\n        fedexPageDetail = fedexData.oneTagPageDetail;\\n      } else {\\n        fedexPageDetail = pageDetail;\\n      }\\n      if(fedexData \\u0026\\u0026 fedexData.oneTagPageType) {\\n        fedexPageType = fedexData.oneTagPageType;\\n      } else {\\n        fedexPageType = pageType;\\n      }\\n\\n      if (accessPointFedexLocation.includes(fedexPageDetail)) {\\n          linkName = \\\"page view\\\";\\n          additionalDataToSend.pageInfo = {\\n            title: fedexPageName\\n          };\\n          additionalDataToSend.sotVars = {\\n          sotSubType: fedexPageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: fedexPageDetail,\\n          sotV02: pageWorld\\n        };\\n      }\\n      \\n      if(reportIssue.indexOf(pageDetail) \\u003e -1) {\\n        linkName = \\\"page view\\\";\\n        var sotV10 = getEventDetail(\\\"data.orderId\\\") || null;\\n        var sotV250 = getEventDetail(\\\"data.reportIssueCode\\\") || null;\\n        var sotV249 = getEventDetail(\\\"data.reportIssueReason\\\") || null;\\n        additionalDataToSend.sotVars = {\\n          sotType: linkName,\\n          sotSubType: pageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld,\\n          sotV10: sotV10,\\n          sotV249: sotV249,\\n          sotV250: sotV250\\n        };\\n      }\\n      //SA-797\\n      if(getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.pageDetail\\\") === \\\"fraud check processing\\\") {\\n        linkName = \\\"page view\\\";\\n        var sotV10 = getEventDetail(\\\"data.originalOrderId\\\") || null;\\n        additionalDataToSend.sotVars = {\\n          sotType: linkName,\\n          sotSubType: pageType,\\n          sotSubCategory: sotSubCategory,\\n          sotV01: pageTypeDetail,\\n          sotV02: pageWorld,\\n          sotV10: sotV10\\n        };\\n      }\\n      \\n      //SA-478\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.linkName\\\") === \\\"same-day unlimited faqs\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: 'contentstore:same-day unlimited faqs:n/a:*'\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || 'contentstore',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.linkName\\\") || 'same-day unlimited faqs',\\n          sotV88: 'same-day unlimited faq click'\\n        };\\n      }\\n      \\n        //SA-880,SA-886,SA-887,SA-879,SA-881, SA-884, SA-885\\n      //console.log(\\\"======\\u003e\\\", getEventDetail(\\\"data.linkData\\\"));\\n      //console.log(\\\"pageType====\\u003e\\\",getEventDetail(\\\"data.pageType\\\"));\\n      //console.log(\\\"pageDetail======\\u003e\\\",getEventDetail(\\\"data.pageDetail\\\"));\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 autoReplenishSDUPageView.indexOf(getEventDetail(\\\"data.linkData\\\")) \\u003e -1) {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || '',\\n          sotV88: formatSotType(getEventDetail(\\\"data.linkData\\\")) || '',\\n        };\\n      }\\n      //SA-847 //SA-1009 //SA-1010 //SA-1011\\n      //console.log(\\\"======\\u003e\\\", getEventDetail(\\\"data\\\"));\\n      //console.log(\\\"pageType====\\u003e\\\",getEventDetail(\\\"data.pageType\\\"));\\n      //console.log(\\\"pageDetail======\\u003e\\\",getEventDetail(\\\"data.pageDetail\\\"));\\n      if(getEventDetail(\\\"data\\\")) {\\n        const eventData = getEventDetail(\\\"data\\\");\\n        const pageDetail = eventData.pageTypeDetail ? eventData.pageTypeDetail : eventData.pageDetail || \\\"\\\";\\n        const pageName = eventData \\u0026\\u0026 eventData.pageName;\\n        const pageType = eventData \\u0026\\u0026 eventData.pageType;\\n        const pageDetailValue = pageDetail || pageType || '';\\n\\n        if (pageDetailValue \\u0026\\u0026 curbSidePageView.includes(pageDetailValue)) {\\n            linkName = \\\"page view\\\";\\n            additionalDataToSend.pageInfo = {\\n              title: pageName || \\\"\\\"\\n            };\\n            additionalDataToSend.sotVars = {\\n              sotSubType: pageType || '',\\n              sotSubCategory: 'n/a',\\n              sotV01: pageDetailValue,\\n              sotV88: 'n/a'\\n          };\\n        }\\n      }\\n      //SA-874\\n      if(getEventDetail(\\\"data\\\") \\u0026\\u0026 orderDetailsPageView.indexOf(getEventDetail(\\\"data.pageTypeDetail\\\")) \\u003e -1) {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: \\\"order:cancelation:reasons:*\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageTypeDetail\\\") || '',\\n          sotV88: 'n/a',\\n        };\\n      }\\n      \\n      //SA-871\\n      //console.log(\\\"data======\\u003e\\\", getEventDetail(\\\"data\\\"));\\n      //console.log(\\\"pageTypeDetail====\\u003e\\\", getEventDetail(\\\"data.pageTypeDetail\\\"));\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.pageTypeDetail\\\") === \\\"mega-filter\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: 'filters:mega:filter:*'\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || 'filters',\\n          sotSubCategory: 'n/a',\\n          sotV01:getEventDetail(\\\"data.pageTypeDetail\\\") || '',\\n          sotV88: 'n/a',\\n        };\\n      }\\n      //SA-872, SA-922\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 autoReplenishSDUPageView.indexOf(getEventDetail(\\\"data.linkData\\\")) \\u003e -1) {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || '',\\n          sotV88: getEventDetail(\\\"data.previousActionType\\\") || '',\\n        };\\n      }\\n      //SA-1014\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data\\\").pageDetail === 'email and text notifications') {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n          title: safelyReadProperty(\\\"page.attributes.sephoraPageInfo.pageName\\\", digitalData)\\n        };\\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.linkName\\\") || '',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || ''\\n        };\\n      }\\n      \\n      //SA-875\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.pageType\\\") === \\\"same-day unlimited\\\" \\u0026\\u0026 getEventDetail(\\\"data.pageTypeDetail\\\") === \\\"cancel subscription\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || 'same-day unlimited',\\n          sotSubCategory: 'n/a',\\n          sotV01:getEventDetail(\\\"data.pageTypeDetail\\\") || '',\\n          sotV88: getEventDetail(\\\"data.previousActionType\\\") || '',\\n        };\\n      }\\n      \\n        //SA-1057\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.linkData\\\") === \\\"free returns click:basket\\\" \\u0026\\u0026 getEventDetail(\\\"data.pageDetail\\\") === \\\"free returns-information\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"returns:free returns-information:n/a:*\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || 'returns',\\n          sotSubCategory: 'n/a',\\n          sotV01:getEventDetail(\\\"data.pageDetail\\\") || 'free returns-information'\\n        };\\n      }\\n\\n      //SA-1017\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.pageType\\\") === \\\"reviews\\\" \\u0026\\u0026 getEventDetail(\\\"data.pageDetail\\\") === \\\"image from reviews\\\") {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n          title: getEventDetail(\\\"data.pageName\\\")\\n        };\\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\"),\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\")\\n        };\\n      }\\n      \\n      //SA-1110\\n      if(getEventDetail(\\\"data\\\") \\u0026\\u0026 beautyPreferencesPageView.indexOf(getEventDetail(\\\"data.pageDetail\\\")) \\u003e -1) {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"product:shade finder-match found:n/a:*\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || '',\\n          sotV88: getEventDetail(\\\"data.previousPageName\\\") || 'n/a',\\n          sotV04: getEventDetail(\\\"data.skuId\\\") || '',\\n          sotV07: getEventDetail(\\\"data.brandName\\\") || '',\\n        };\\n      }\\n      \\n      //SA-1115, SA-1116, SA-1410, SA-1411\\n      if(getEventDetail(\\\"data\\\") \\u0026\\u0026 smsSignUpPageView.indexOf(getEventDetail(\\\"data.pageDetail\\\")) \\u003e -1) {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || '',\\n          sotV10: getEventDetail(\\\"data.orderId\\\") || '',\\n          sotV63: getEventDetail(\\\"data.orderShippingMethod\\\") || '',\\n        };\\n      }\\n      \\n        //SA-1265\\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data\\\").previousActionType === 'beauty preferences sign in to save') {\\n        linkName = \\\"page view\\\";\\n        additionalDataToSend.pageInfo = {\\n          title: safelyReadProperty(\\\"page.attributes.sephoraPageInfo.pageName\\\", digitalData) || 'mysephora:beauty preferences:n/a:*'\\n        };\\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || 'sign in',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || 'sign in',\\n          sotV88: getEventDetail(\\\"data\\\").previousActionType || 'beauty preferences sign in to save'\\n        };\\n      }\\n      //SA-1263, SA-1264, SA-1323\\n      if(getEventDetail(\\\"data\\\")) {\\n        const eventData = getEventDetail(\\\"data\\\");\\n        let pageType = (eventData.pageTypeDetail) ? eventData.pageTypeDetail : eventData.pageDetail || \\\"\\\";\\n        if(beautyPreferenccesAccordionPageView.includes(pageType)) {\\n          linkName = \\\"page view\\\";\\n          let sotV260 = eventData.accordionName || \\\"\\\";\\n          additionalDataToSend.pageInfo = {\\n            title: safelyReadProperty(\\\"page.attributes.sephoraPageInfo.pageName\\\", digitalData) || 'mysephora:beauty preferences:n/a:*'\\n          };\\n          additionalDataToSend.sotVars = {\\n            sotSubType: eventData.pageType || '',\\n            sotSubCategory: 'n/a',\\n            sotV01: pageType || '',\\n            sotV260: sotV260\\n          };\\n      }\\n      }\\n      //SA-1337\\n      if(getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.pageDetail\\\") === \\\"bi signup spoke\\\") {\\n        linkName = \\\"page view\\\";\\n        let sotV260 = (getEventDetail(\\\"data.world\\\") !== \\\"beauty preference saved\\\") ? getEventDetail(\\\"data.world\\\") : \\\"\\\";\\n        additionalDataToSend.pageInfo = {\\n          title: getEventDetail(\\\"data.pageName\\\") || 'mysephora:bi signup spoke:skin concerns:*'\\n        };\\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: (getEventDetail(\\\"data.world\\\") === \\\"beauty preference saved\\\") ? getEventDetail(\\\"data.world\\\") : getEventDetail(\\\"data.pageDetail\\\") || '',\\n          sotV260: sotV260\\n        };\\n      }\\n      \\n      if (getEventDetail(\\\"data\\\") \\u0026\\u0026 basketShippingPageView.indexOf(getEventDetail(\\\"data.linkData\\\")) \\u003e -1) {\\n        linkName = getEventDetail(\\\"data.linkData\\\");\\n        //console.log(\\\"linkName====\\\", getEventDetail(\\\"data\\\"), linkName);\\n        const productString = getEventDetail(\\\"data.productStrings\\\") || getEventDetail(\\\"data.skuIds\\\") || \\\"\\\";\\n        const sotV04 = extractNumberAfterEqualSign(productString);\\n        const sotV63 = getEventDetail(\\\"data.shippingMethod\\\") || \\\"\\\";\\n        const sotV06 = getEventDetail(\\\"data.listSubTotal\\\") || \\\"\\\";\\n        additionalDataToSend.pageInfo = {\\n            title: getEventDetail(\\\"data.pageName\\\") || \\\"\\\"\\n        }; \\n        additionalDataToSend.sotVars = {\\n          sotSubType: getEventDetail(\\\"data.pageType\\\") || '',\\n          sotSubCategory: 'n/a',\\n          sotV01: getEventDetail(\\\"data.pageDetail\\\") || '',\\n          sotV04,\\n          sotV06,\\n          sotV63,\\n          sotV88: getEventDetail(\\\"data.previousActionType\\\") || '',\\n        };\\n      }\\n      \\n      //SA-4039\\n      if(getEventDetail(\\\"data\\\") \\u0026\\u0026 getEventDetail(\\\"data.internalCampaign\\\") === \\\"modal-open:fedex_pickup_location_info_modal\\\") {\\n         linkName = \\\"page view\\\";\\n           additionalDataToSend.sotVars = {\\n            sotSubType: \\\"contentstore\\\",\\n            sotSubCategory: 'n/a',\\n            sotV01: \\\"fedex access points-how it works\\\" || ''\\n          };\\n      }\\n      \\n        if(getEventDetail(\\\"data\\\")) {\\n        const eventData = getEventDetail(\\\"data\\\");\\n        let pageType = (eventData.pageDetail) ? eventData.pageDetail : \\\"\\\";\\n        if(creditCardPageView.includes(pageType)) {\\n          linkName = \\\"page view\\\";\\n          additionalDataToSend.pageInfo = {\\n            title: safelyReadProperty(\\\"page.attributes.sephoraPageInfo.pageName\\\", digitalData) || eventData.pageName || \\\"\\\"\\n          };\\n          additionalDataToSend.sotVars = {\\n            sotSubType: eventData.pageType || \\\"creditcard\\\",\\n            sotSubCategory: 'n/a',\\n            sotV01: pageType || '',\\n            sotV88: eventData.previousPageName || \\\"\\\",\\n            sotV134: eventData.creditCardStatus || \\\"\\\"\\n          };\\n      }\\n      }\\n\\n      var formattedSotType = formatSotType(linkName);\\n      if (formattedSotType === 'page view') {\\n        additionalDataToSend.sotVars.sotV277 = ipAddress;\\n      }\\n\\n      allowedLinkActionInfo = allowedLinkActionInfo.concat(set14OnwardsEvents);\\n\\n      Object.assign(additionalDataToSend.sotVars, dataToSend.sotVars);\\n\\n      var callNewEvtApi = false;\\n      if (set14OnwardsEvents.indexOf(linkName) \\u003e -1) {\\n        callNewEvtApi = true;\\n      }\\n    \\n      //For Adobe Async Page View Events\\n      var isValidLinkName = getValidLinkName(linkName);\\n      //console.log('validLinkName-\\u003e', linkName, isValidLinkName);\\n    if(isValidLinkName) {\\n      if (allowedLinkActionInfo.indexOf(linkName) != -1) {\\n        (window.sephoraOneTag_cmds = window.sephoraOneTag_cmds || []).push(['trackEvent', formattedSotType, additionalDataToSend, null, callNewEvtApi]);\\n      }\\n    }\\n\\n    // XSEL-4705 XSEL-4633\\n    if(eventInfoAttributes.pageType === 'reviews' \\u0026\\u0026 eventInfoAttributes.pageDetail === 'ratings\\u0026reviews-submit') {\\n      setTimeout(() =\\u003e {\\n        (window.sephoraOneTag_cmds = window.sephoraOneTag_cmds || []).push(['trackEvent', 'completed review', additionalDataToSend, null, true]);\\n      }, 100);\\n    }\\n    \\n    }\\n  }\\n  catch (error) {\\n    console.log(\\\"Failed in SOT - Async Page View Tag\\\", error);\\n  }\\n})();\",\"language\":\"javascript\"}"
    },
    "relationships": {
        "updated_with_extension_package": {
            "links": {
                "related": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/updated_with_extension_package"
            },
            "data": {
                "id": "EP1fdd2a6ec2ae468fb1d2cac08df65f83",
                "type": "extension_packages"
            }
        },
        "updated_with_extension": {
            "links": {
                "related": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/updated_with_extension"
            },
            "data": {
                "id": "EX35ce3802460d499b9f4c856d69a764b4",
                "type": "extensions"
            }
        },
        "extension": {
            "links": {
                "related": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/extension"
            },
            "data": {
                "id": "EX881e591abc3d4b29b9681e2a4d337f74",
                "type": "extensions"
            }
        },
        "notes": {
            "links": {
                "related": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/notes"
            }
        },
        "origin": {
            "links": {
                "related": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/origin"
            },
            "data": {
                "id": "RC7bfe1578a339443b88c5ce8f2f124265",
                "type": "rule_components"
            }
        },
        "property": {
            "links": {
                "related": "https://reactor.adobe.io/properties/PR28bc45fcba184e70b64b2f0cf7fe70f8"
            },
            "data": {
                "id": "PR28bc45fcba184e70b64b2f0cf7fe70f8",
                "type": "properties"
            }
        },
        "rules": {
            "links": {
                "related": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/rules"
            }
        }
    },
    "links": {
        "extension": "https://reactor.adobe.io/extensions/EX881e591abc3d4b29b9681e2a4d337f74",
        "origin": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265",
        "rules": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265/rules",
        "self": "https://reactor.adobe.io/rule_components/RC7bfe1578a339443b88c5ce8f2f124265"
    },
    "meta": {
        "latest_revision_number": 195
    }
}
